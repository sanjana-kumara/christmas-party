<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sperenza 2025 Registration</title>
    <link rel="shortcut icon" href="Speranza.png" type="image/x-icon">
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Great+Vibes&family=Montserrat:wght@400;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Mountains+of+Christmas:wght@700&family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">

    <style>
        /* --- 0. Global Reset --- */
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body {
            font-family: 'Montserrat', sans-serif;
            margin: 0;
            background-color: #f4f4f4; /* Fallback color */
            /* Cursors sparkles will be appended to the body, hide overflow */
            overflow: hidden;
            /* HIDE THE DEFAULT SYSTEM CURSOR */
            cursor: none; 
        }

        /* --- 1. Splash Screen Styling --- */
        #splash-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100vh;
            background: radial-gradient(circle, #b82a31, #a6262c 80%);
            overflow: hidden;
            display: flex;
            justify-content: center;
            align-items: center;
            text-align: center;
            z-index: 9999;
            transition: transform 1s cubic-bezier(0.8, 0.0, 0.2, 1), opacity 1s ease;
        }
        .splash-content {
            z-index: 10; /* Ensures content is above the snow */
            color: white;
        }
        .glowing-star {
            font-size: 2.5rem; color: #ffd700; opacity: 0; animation: pulseGlow 2s infinite ease-in-out; animation-delay: 0.2s;
            text-shadow: 0 0 10px #ffd700, 0 0 20px #ffd700, 0 0 30px #ffc400;
        }
        @keyframes pulseGlow { 0%, 100% { opacity: 0.8; transform: scale(1); } 50% { opacity: 1; transform: scale(1.1); } }
        
        .splash-content h1 {
            font-family: 'Great Vibes', cursive; font-size: 5rem; font-weight: normal; margin: 0;
        }
        .splash-content h1 span {
            display: inline-block; opacity: 0; transform: scale(0);
            text-shadow: 0 0 5px #fff, 0 0 10px #fff, 0 0 20px #ffd700;
            animation: letterPopIn 0.6s forwards cubic-bezier(0.2, 0.8, 0.2, 1);
        }
        .splash-content h1 span.space { width: 1rem; }
        @keyframes letterPopIn { to { opacity: 1; transform: scale(1); } }
        .splash-content h1 span:nth-child(1) { animation-delay: 0.5s; } .splash-content h1 span:nth-child(2) { animation-delay: 0.6s; } .splash-content h1 span:nth-child(3) { animation-delay: 0.7s; } .splash-content h1 span:nth-child(4) { animation-delay: 0.8s; } .splash-content h1 span:nth-child(5) { animation-delay: 0.9s; } .splash-content h1 span:nth-child(7) { animation-delay: 1.1s; } .splash-content h1 span:nth-child(8) { animation-delay: 1.2s; } .splash-content h1 span:nth-child(9) { animation-delay: 1.3s; } .splash-content h1 span:nth-child(10) { animation-delay: 1.4s; } .splash-content h1 span:nth-child(11) { animation-delay: 1.5s; } .splash-content h1 span:nth-child(12) { animation-delay: 1.6s; } .splash-content h1 span:nth-child(13) { animation-delay: 1.7s; }
        
        .splash-content h2 {
            font-family: 'Montserrat', sans-serif; font-size: 1.5rem; font-weight: 400; letter-spacing: 4px; text-transform: uppercase; margin-top: 1rem; opacity: 0; animation: fadeInUp 1s forwards cubic-bezier(0.2, 0.8, 0.2, 1); animation-delay: 2.0s;
        }
        #splash-screen.hidden {
            transform: translateY(-100%); opacity: 0;
        }
        @keyframes fadeInUp { from { opacity: 0; transform: translateY(40px); } to { opacity: 1; transform: translateY(0); } }
        
        /* --- 2. Snow Animation Styling --- */
        #snow-container, .snow-layer-main {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; z-index: 1;
        }
        .snowflake {
            position: absolute; top: -10vh; background: white; border-radius: 50%; opacity: 0; animation: fall-splash linear infinite;
        }
        @keyframes fall-splash { from { opacity: 0; transform: translateY(0) translateX(0); } 10% { opacity: 1; } to { opacity: 1; transform: translateY(120vh) translateX(8vw); } }
        .snowflake:nth-child(1) { left: 10%; width: 8px; height: 8px; animation-duration: 10s; animation-delay: 0s; } .snowflake:nth-child(2) { left: 20%; width: 4px; height: 4px; animation-duration: 10s; animation-delay: 1s; } .snowflake:nth-child(3) { left: 30%; width: 6px; height: 6px; animation-duration: 15s; animation-delay: 2s; } .snowflake:nth-child(4) { left: 40%; width: 3px; height: 3px; animation-duration: 6s; animation-delay: 0.5s; } .snowflake:nth-child(5) { left: 50%; width: 7px; height: 7px; animation-duration: 11s; animation-delay: 3s; } .snowflake:nth-child(6) { left: 60%; width: 4px; height: 4px; animation-duration: 8s; animation-delay: 1.5s; } .snowflake:nth-child(7) { left: 70%; width: 5px; height: 5px; animation-duration: 12s; animation-delay: 4s; } .snowflake:nth-child(8) { left: 80%; width: 3px; height: 3px; animation-duration: 7s; animation-delay: 2.5s; } .snowflake:nth-child(9) { left: 90%; width: 6px; height: 6px; animation-duration: 9s; animation-delay: 0.2s; } .snowflake:nth-child(10) { left: 5%; width: 8px; height: 8px; animation-duration: 13s; animation-delay: 1s; } .snowflake:nth-child(11) { left: 15%; width: 4px; height: 4px; animation-duration: 7s; animation-delay: 3s; } .snowflake:nth-child(12) { left: 25%; width: 5px; height: 5px; animation-duration: 10s; animation-delay: 5s; } .snowflake:nth-child(13) { left: 35%; width: 3px; height: 3px; animation-duration: 8s; animation-delay: 2s; } .snowflake:nth-child(14) { left: 45%; width: 7px; height: 7px; animation-duration: 11s; animation-delay: 0s; } .snowflake:nth-child(15) { left: 55%; width: 4px; height: 4px; animation-duration: 9s; animation-delay: 1.8s; } .snowflake:nth-child(16) { left: 65%; width: 6px; height: 6px; animation-duration: 12s; animation-delay: 3.5s; } .snowflake:nth-child(17) { left: 75%; width: 3px; height: 3px; animation-duration: 6s; animation-delay: 2.8s; } .snowflake:nth-child(18) { left: 85%; width: 8px; height: 8px; animation-duration: 10s; animation-delay: 4.5s; } .snowflake:nth-child(19) { left: 95%; width: 5px; height: 5px; animation-duration: 8s; animation-delay: 1.2s; } .snowflake:nth-child(20) { left: 12%; width: 4px; height: 4px; animation-duration: 11s; animation-delay: 0.7s; }

        
        /* --- 2.5 (MODIFIED) Floating Snowflakes --- */
        .orb-container {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            overflow: hidden;
            z-index: 0; /* Behind snow (1) and form (2) */
            pointer-events: none;
        }
        .orb {
            position: absolute;
            bottom: -150px; /* Start below the screen */
            color: white;
            animation: floatUp 20s linear infinite;
        }
        /* Use a pseudo-element for the snowflake character */
        .orb::before {
            content: '‚ùÑ'; /* Snowflake character */
            position: absolute;
            left: 0;
            top: 0;
            
            /* The golden glow shadow you liked, applied as text-shadow */
            text-shadow: 0 0 8px rgba(255, 215, 0, 0.4), 
                         0 0 20px rgba(255, 215, 0, 0.5),
                         0 0 35px rgba(255, 215, 0, 0.3);
        }

        @keyframes floatUp {
            from {
                transform: translateY(0) scale(1) translateX(0);
                opacity: 0.7;
            }
            to {
                /* Float up and slightly drift horizontally */
                transform: translateY(-120vh) scale(0.5) translateX(5vw);
                opacity: 0;
            }
        }
        
        /* Different font-sizes, positions, and speeds */
        .orb:nth-child(1) { font-size: 80px; left: 10%; animation-duration: 25s; animation-delay: 0s; }
        .orb:nth-child(2) { font-size: 40px; left: 30%; animation-duration: 20s; animation-delay: 5s; }
        .orb:nth-child(3) { font-size: 120px; left: 50%; animation-duration: 30s; animation-delay: 2s; }
        .orb:nth-child(4) { font-size: 60px; left: 75%; animation-duration: 18s; animation-delay: 8s; }
        .orb:nth-child(5) { font-size: 90px; left: 90%; animation-duration: 22s; animation-delay: 12s; }
        .orb:nth-child(6) { font-size: 50px; left: -5%; animation-duration: 28s; animation-delay: 15s; }
        /* --- END OF MODIFIED CSS --- */

        /* --- 2.6 (NEW) Custom Cursor & Sparkle Effect --- */
        #custom-cursor {
            position: fixed;
            width: 30px; /* Slightly larger for the snowflake */
            height: 30px;
            transform: translate(-50%, -50%);
            pointer-events: none;
            z-index: 10000;
            transition: transform 0.2s ease; /* Updated transition */
        }
        
        /* NEW: SVG styling for the snowflake */
        #custom-cursor svg {
            width: 100%;
            height: 100%;
            color: rgba(255, 215, 0, 0.9); /* Gold color */
            
            /* The golden glow */
            filter: drop-shadow(0 0 2px rgba(255, 215, 0, 0.7)) 
                    drop-shadow(0 0 5px rgba(255, 215, 0, 0.5));
            
            /* NEW: Gentle rotation animation */
            animation: cursor-spin 20s linear infinite;
            transition: all 0.2s ease;
        }

        /* NEW: Keyframes for the cursor rotation */
        @keyframes cursor-spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        /* Click animation - now scales down */
        #custom-cursor.clicked {
            transform: translate(-50%, -50%) scale(0.8);
        }
        #custom-cursor.clicked svg {
            /* Make it glow brighter on click */
            filter: drop-shadow(0 0 3px rgba(255, 255, 255, 1)) 
                    drop-shadow(0 0 8px rgba(255, 215, 0, 1));
        }

        .sparkle {
            position: fixed; /* Use fixed to follow viewport cursor */
            width: 8px;
            height: 8px;
            background: #fff;
            border-radius: 50%;
            pointer-events: none; /* Crucial so it doesn't block clicks */
            z-index: 9998; /* Above main content, below splash */
            
            /* White/Gold glow */
            box-shadow: 0 0 5px #fff, 0 0 10px #fff, 0 0 15px #ffd700;
            
            /* Animation to fade and shrink */
            animation: sparkle-fade 0.6s forwards ease-out;
            
            /* JS will set top/left. Need to center on cursor. */
            transform: translate(-50%, -50%); 
        }

        @keyframes sparkle-fade {
            from {
                opacity: 1;
                transform: translate(-50%, -50%) scale(1.2);
            }
            to {
                opacity: 0;
                transform: translate(-50%, -50%) scale(0);
            }
        }
        /* --- END OF NEW CSS --- */

        /* --- 3. Main Content & Form Styling --- */
        
        #main-content {
            font-family: 'Poppins', sans-serif;
            background: linear-gradient(135deg, #a80000, #004d00, #d90429, #008000);
            background-size: 400% 400%; /* For gradient animation */
            animation: gradientBG 15s ease infinite;
            display: grid;
            place-items: center;
            min-height: 100vh;
            width: 100%;
            overflow: hidden; /* Hides snow that goes outside */
            position: relative;
            padding: 15px 0;
            display: none; /* Initially hidden until splash screen is gone */
        }

        /* Animated gradient background keyframes */
        @keyframes gradientBG { 0%, 100% { background-position: 0% 50%; } 50% { background-position: 100% 50%; } }

        /* "Glassmorphism" form container */
        .form-container {
            background: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(12px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 20px;
            box-shadow: 0 8px 32px 0 rgba(0, 80, 0, 0.37);
            width: 400px;
            max-width: 95%;
            padding: 35px;
            color: #fff;
            animation: fadeInDown 0.8s ease-out;
            position: relative;
            z-index: 2; /* Form is above the snow layer (1) and orbs (0) */
            max-height: 90vh; /* Max height for mobile */
            overflow-y: auto; /* Allows scrolling if content is too tall */
            
            /* --- SCROLLBAR HIDE STYLES --- */
            -ms-overflow-style: none;  /* Hides scrollbar for IE and Edge */
            scrollbar-width: none;  /* Hides scrollbar for Firefox */

            /* --- NEW: For 3D Tilt Effect --- */
            transition: transform 0.1s ease-out;
            transform-style: preserve-3d;
        }
        
        /* Hides scrollbar for Chrome, Safari, Opera */
        .form-container::-webkit-scrollbar { 
            display: none; 
        } 
        
        /* Form container fade-in animation */
        @keyframes fadeInDown { from { opacity: 0; transform: translateY(-30px); } to { opacity: 1; transform: translateY(0); } }
        
        /* Form elements styling */
        .form-container h2 { font-family: 'Mountains of Christmas', cursive; font-size: 3rem; text-align: center; color: #fff; text-shadow: 2px 2px 8px rgba(0, 0, 0, 0.5); margin-bottom: 5px; transform: translateZ(20px); /* Makes text pop in 3D */ } 
        .form-container p { text-align: center; font-weight: 300; margin-bottom: 30px; font-size: 1.1rem; transform: translateZ(10px); } 
        .form-group { margin-bottom: 20px; position: relative; transform: translateZ(10px); } /* Needed for suggestion box */
        .form-group label { display: block; margin-bottom: 8px; font-weight: 400; color: #f0f0f0; text-shadow: 1px 1px 2px rgba(0,0,0,0.4); } 
        .form-group input, .form-group select { width: 100%; padding: 14px; background: rgba(255, 255, 255, 0.1); border: 1px solid rgba(255, 255, 255, 0.3); border-radius: 10px; color: #fff; font-family: 'Poppins', sans-serif; font-size: 1rem; transition: all 0.3s ease; -webkit-appearance: none; -moz-appearance: none; appearance: none; } 
                
        .form-group input:focus, .form-group select:focus { outline: none; background: rgba(255, 255, 255, 0.2); border-color: #fff; box-shadow: 0 0 15px rgba(255, 255, 255, 0.6); } 
        .form-group input::placeholder { color: #ddd; } 
        /* Validation error style for inputs */
        .form-group input.invalid, .form-group select.invalid { border-color: #ff4c4c; background: rgba(255, 76, 76, 0.15); } 
        /* Utility class to hide/show form sections */
        .hidden-field { display: none !important; }
        
        /* Button styling */
        .btn { background: linear-gradient(45deg, #00b300, #008000); color: white; padding: 15px 20px; border: none; border-radius: 10px; cursor: none; /* Use custom cursor */ width: 100%; font-size: 1.1rem; font-weight: 600; font-family: 'Poppins', sans-serif; box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2); transition: all 0.3s ease; margin-top: 10px; text-decoration: none; display: inline-block; text-align: center; transform: translateZ(15px); } 
        .btn:hover { background: linear-gradient(45deg, #00cc00, #009900); box-shadow: 0 6px 20px rgba(0, 0, 0, 0.3); transform: translateY(-3px) translateZ(15px); } 
        .btn:active { transform: translateY(-1px) translateZ(15px); box-shadow: 0 3px 10px rgba(0, 0, 0, 0.3); } 
        .btn:disabled { background: #555; cursor: not-allowed; opacity: 0.7; } 
        
        /* --- 4. Batch Suggestion Box Styling --- */
        #batch-suggestions {
            display: none; /* Hidden by default */
            position: absolute;
            top: 100%; /* Positioned right below the input */
            left: 0;
            right: 0;
            background: rgba(40, 40, 40, 0.95);
            backdrop-filter: blur(5px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-top: none;
            border-radius: 0 0 10px 10px;
            z-index: 10;
            max-height: 150px;
            overflow-y: auto;

            /* --- SCROLLBAR HIDE STYLES (for suggestion box too) --- */
            -ms-overflow-style: none;  /* IE and Edge */
            scrollbar-width: none;  /* Firefox */
        }
        #batch-suggestions::-webkit-scrollbar { 
            display: none; /* Chrome, Safari, Opera */
        }
        /* Individual suggestion item */
        .suggestion-item {
            padding: 12px 15px;
            color: #fff;
            cursor: none; /* Use custom cursor */
            transition: background 0.2s ease;
            font-size: 0.95rem;
        }
        .suggestion-item:hover {
            background: rgba(255, 255, 255, 0.2);
        }
        
        /* --- 5. Message & Loading Indicators --- */
        #message { 
            text-align: center; font-weight: 600; font-size: 1.1rem; position: fixed; top: 20px; left: 50%; transform: translateX(-50%); z-index: 100; max-width: 90%; color: #fff; background: rgba(0,0,0,0); padding: 0; border-radius: 10px; opacity: 0; transition: background 0.3s ease, padding 0.3s ease, opacity 0.3s ease; pointer-events: none; 
        } 
        /* Style for when message is not empty */
        #message:not(:empty) { 
            background: rgba(0,0,0,0.5); padding: 10px 20px; opacity: 1; pointer-events: auto; 
        } 
        #loading { 
            text-align: center; display: none; margin-top: 20px; font-weight: 300; position: fixed; bottom: 20px; left: 50%; transform: translateX(-50%); z-index: 100; background: rgba(0,0,0,0.5); padding: 10px 20px; border-radius: 10px; color: #fff; 
        }

        /* --- 6. Mobile Responsive Styles --- */
        @media (max-width: 480px) {
            /* Hide custom cursor effects on mobile, they don't apply */
            #custom-cursor, .sparkle {
                display: none;
            }
            body {
                cursor: auto; /* Show default cursor */
            }
            .btn, .suggestion-item {
                cursor: pointer; /* Show pointer on touch */
            }

            .splash-content h1 { font-size: 3.5rem; } .splash-content h2 { font-size: 1rem; } .glowing-star { font-size: 2rem; }
            .form-container { padding: 25px; max-height: 95vh; width: 95%; } 
            .form-container h2 { font-size: 2.4rem !important; } 
            .form-container p { font-size: 1rem; margin-bottom: 25px; } 
            .form-group { margin-bottom: 15px; } 
            .form-group input, .form-group select { padding: 12px; font-size: 0.95rem; }             
            .btn { padding: 14px 20px; font-size: 1rem; } 
            #thankyou-container h2 { font-size: 2.6rem !important; } 
            #thankyou-container p { font-size: 1rem !important; }
        }

        /* --- 7. Typing Animation (Footer) --- */
        .typing-effect {
            color: white;
            font-size: smaller;
            font-family: monospace; 
            overflow: hidden; 
            white-space: nowrap; 
            border-right: .1em solid white; /* The cursor */
            width: 0; 
            /* Run 'typing' animation forwards/backwards infinitely */
            /* Run 'blink' animation infinitely */
            animation: 
                typing 4s steps(34) infinite alternate,
                blink .75s step-end infinite;
        }
        /* Keyframes for typing out and pausing */
        @keyframes typing {
            0% { width: 0; } /* Start hidden */
            80% { width: 34ch; } /* Type out to 34 characters */
            100% { width: 34ch; } /* Pause at full width */
        }
        /* Keyframes for the blinking cursor */
        @keyframes blink {
            from, to { border-color: transparent; } /* Cursor hidden */
            50% { border-color: white; } /* Cursor visible */
        }

    </style>
</head>
<body>

    <!-- Custom cursor element with SVG inside --><div id="custom-cursor">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
            <path d="M12 2v20"></path><path d="M12 12l-8.66-5"></path><path d="M12 12l8.66-5"></path><path d="M12 12l-8.66 5"></path><path d="M12 12l8.66 5"></path><path d="M5.2 6.8l-3.03 1.75"></path><path d="M18.8 6.8l3.03 1.75"></path><path d="M5.2 17.2l-3.03-1.75"></path><path d="M18.8 17.2l3.03-1.75"></path>
        </svg>
    </div>

    <div id="splash-screen">
        <div id="snow-container"> 
            <div class="snowflake"></div> <div class="snowflake"></div> <div class="snowflake"></div> <div class="snowflake"></div> <div class="snowflake"></div> <div class="snowflake"></div> <div class="snowflake"></div> <div class="snowflake"></div> <div class="snowflake"></div> <div class="snowflake"></div> <div class="snowflake"></div> <div class="snowflake"></div> <div class="snowflake"></div> <div class="snowflake"></div> <div class="snowflake"></div> <div class="snowflake"></div> <div class="snowflake"></div> <div class="snowflake"></div> <div class="snowflake"></div> <div class="snowflake"></div>
        </div>
        <div class="splash-content">
            <div class="glowing-star">‚òÖ</div>
            <h1>
                <span>M</span><span>e</span><span>r</span><span>r</span><span>y</span> <span class="space"> </span> <span>C</span><span>h</span><span>r</span><span>i</span><span>s</span><span>t</span><span>m</span><span>a</span><span>s</span>
            </h1>
            <h2>Sperenza 2025</h2>
        </div>
    </div>
    
    <main id="main-content">

        <!-- ‚ñº‚ñº‚ñº FLOATING SNOWFLAKES HTML (formerly Orbs) ‚ñº‚ñº‚ñº --><div class="orb-container">
            <div class="orb"></div>
            <div class="orb"></div>
            <div class="orb"></div>
            <div class="orb"></div>
            <div class="orb"></div>
            <div class="orb"></div>
        </div>
        <!-- ‚ñ≤‚ñ≤‚ñ≤ END OF HTML ‚ñ≤‚ñ≤‚ñ≤ --><div class="snow-layer-main" id="snow-container-main"> 
            <div class="snowflake"></div><div class="snowflake"></div> 
            <div class="snowflake"></div><div class="snowflake"></div> 
            <div class="snowflake"></div><div class="snowflake"></div>
            </div>

        <div id="message"></div> 
        
        <div class="form-container" id="registration-container">
                <h2>Christmas Party 2025</h2> <p>Register Now!</p> 
                <form id="registration-form"> 
                    <div class="form-group"> 
                        <label for="name">Name :-</label> 
                        <input type="text" id="name" name="name" placeholder="Enter your name" required> 
                    </div> 
                    <div class="form-group"> 
                        <label for="email">Email :-</label> 
                        <input type="email" id="email" name="email" placeholder="Enter email address" required> 
                    </div> 
                    <div class="form-group"> 
                        <label for="nic">NIC:</label> 
                        <input type="text" id="nic" name="nic" placeholder="Enter your nic" required> 
                    </div> 
                    <div class="form-group"> 
                        <label for="whatsapp">WhatsApp No :-</label> 
                        <input type="tel" id="whatsapp" name="whatsapp" placeholder="Enter your number" required> 
                    </div> 
                    
                    <div class="form-group"> <label for="batch-input">Batch :-</label> 
                        <input type="text" id="batch-input" name="batch" placeholder="Type your batch name" required autocomplete="off">
                        <div id="batch-suggestions"></div> </div> 
                    
                    <button type="submit" class="btn" id="submit-btn">Get Verification Code</button> 
                </form>
        </div>
        
        <div class="form-container hidden-field" id="otp-container">
                <h2>Verify Your Email</h2> <p>Enter the 6-digit code we sent to your email.</p> <form id="otp-form"> <div class="form-group"> <label for="otp-code">Verification Code (OTP):</label> <input type="number" id="otp-code" name="otp" placeholder="123456" required> </div> <button type="submit" class="btn" id="verify-btn">Verify & Register</button> </form>
        </div>
        
        <div class="form-container hidden-field" id="thankyou-container">
                <h2 style="font-size: 3.5rem;">Thank You! üéÑ</h2> <p style="font-size: 1.2rem; line-height: 1.7;"> Your registration for <strong>SPERANZA'25</strong> is complete! <br><br> We have sent your official QR Code Invitation to your email. Please check your inbox (and spam folder). <br><br> See you at the party! üéÖ </p>
        </div>
        
        <div id="loading">Registering, please wait...</div>

        <div class="typing-effect">Develop By :- SK Software Solution</div>
    
    </main> 

    <script>
        // --- 1. Splash Screen Logic ---
        document.addEventListener('DOMContentLoaded', () => {
            const splashScreen = document.getElementById('splash-screen');
            const mainContent = document.getElementById('main-content');
            // Total time splash screen is visible (in milliseconds)
            const splashDuration = 8500; // 8.5 seconds

            function hideSplash() {
                // Add 'hidden' class to trigger CSS transition
                splashScreen.classList.add('hidden'); 
                // Make the main content visible (but still off-screen)
                mainContent.style.display = 'grid';
                
                // After splash screen slide-up animation (1s)
                setTimeout(() => {
                    splashScreen.remove(); // Remove splash screen from DOM
                    
                    // Small delay to ensure 'display: grid' is rendered
                    setTimeout(() => {
                        const registrationContainer = document.getElementById('registration-container');
                        if (registrationContainer) {
                            // Trigger the fade-in animation for the form
                            registrationContainer.style.opacity = '1'; 
                            registrationContainer.style.transition = 'opacity 0.8s ease-in';
                        }
                    }, 50); 

                }, 1000); // Must match CSS transition duration
            }
            // Set the main timer to hide the splash screen
            setTimeout(hideSplash, splashDuration);
        });


        // --- 2. Form Logic ---
        
        // --- Get all necessary DOM elements ---
        const registrationContainer = document.getElementById('registration-container'); 
        const regForm = document.getElementById('registration-form'); 
        const submitButton = document.getElementById('submit-btn'); 
        const otpContainer = document.getElementById('otp-container'); 
        const otpForm = document.getElementById('otp-form'); 
        const otpInput = document.getElementById('otp-code'); 
        const verifyButton = document.getElementById('verify-btn'); 
        const thankyouContainer = document.getElementById('thankyou-container'); 
        const messageDiv = document.getElementById('message'); 
        const loadingDiv = document.getElementById('loading'); 
        const nameInput = document.getElementById('name'); 
        const emailInput = document.getElementById('email'); 
        const nicInput = document.getElementById('nic'); 
        const whatsappInput = document.getElementById('whatsapp'); 
        const batchInput = document.getElementById('batch-input'); 
        const suggestionsContainer = document.getElementById('batch-suggestions'); 
        
        // --- Regex for validation ---
        const emailRegex = /^[a-zA-Z0-9._%+-]+@(gmail|yahoo|hotmail|outlook|gov|live)\.(com|lk|edu\.lk|ac\.lk|gov\.lk|sch\.lk|org\.lk|net|in)$/; 
        const phoneRegex = /^(?:0|94|\+94|0094)?(?:(11|21|23|24|25|26|27|31|32|33|34|35|36|37|38|41|45|47|51|52|54|55|57|63|65|66|67|81|91)(0|2|3|4|5|7|9)|7(0|1|2|4|5|6|7|8)\d)\d{6}$/; 
        const nicRegex = /^(\d{9}[vV]|\d{12})$/;
        
        // --- Google Apps Script Web App URL ---
        const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbwFH3mUAIRAfoxg0Xcd8VG-oi-wCXepBDCibJgcOc1N65yMegcGKAjwG3UKvYccGflXGg/exec"; // IMPORTANT: Replace if you redeploy!
        let pendingFormData = null; // Stores form data between OTP request and verification

        // --- List of batches for suggestions ---
        const batchSuggestionsList = [
            'Narwal', 
            'Moose', 
            'Ethiina', 
            'Chort8', 
            'Giraf', 
            'Godzila', 
            'Falcon',
            'Gazelle'
        ];

        // --- Helper function to show messages to the user ---
        function showMessage(text, color = "#fff") { 
            messageDiv.textContent = text; 
            messageDiv.style.color = color; 
            // Set background color based on message type (error, success, info)
            if (color === "#ff4c4c") { messageDiv.style.background = "rgba(200,0,0,0.8)"; } 
            else if (color === "#4cff4c") { messageDiv.style.background = "rgba(0,100,0,0.8)"; } 
            else { messageDiv.style.background = "rgba(0,0,0,0.5)"; } 
            // Clear message after 4 seconds
            setTimeout(() => { messageDiv.textContent = ''; }, 4000); 
        }

        // --- Batch suggestion box logic ---
        batchInput.addEventListener('input', () => {
            const query = batchInput.value.trim().toLowerCase();
            suggestionsContainer.innerHTML = ''; // Clear old suggestions
            
            if (query.length === 0) {
                suggestionsContainer.style.display = 'none';
                return;
            }
            
            // Filter the list based on user input
            const filteredBatches = batchSuggestionsList.filter(batch => 
                batch.toLowerCase().includes(query)
            );

            // Create and display suggestion items
            if (filteredBatches.length > 0) {
                filteredBatches.forEach(batch => {
                    const item = document.createElement('div');
                    item.classList.add('suggestion-item');
                    item.textContent = batch;
                    // Add click listener to fill input when suggestion is clicked
                    item.addEventListener('click', () => {
                        batchInput.value = batch; 
                        suggestionsContainer.innerHTML = '';
                        suggestionsContainer.style.display = 'none';
                    });
                    suggestionsContainer.appendChild(item);
                });
                suggestionsContainer.style.display = 'block';
            } else {
                suggestionsContainer.style.display = 'none';
            }
        });

        // --- Hide suggestion box if user clicks outside of it ---
        document.addEventListener('click', (e) => {
            if (!batchInput.contains(e.target) && !suggestionsContainer.contains(e.target)) {
                suggestionsContainer.style.display = 'none';
            }
        });
        
        // --- STEP 1: Handle Registration Form Submit (Send OTP) ---
        regForm.addEventListener('submit', function(e) { 
            e.preventDefault(); // Stop default form submission
            if (!validateLocalForm()) return; // Run validation first
            
            submitButton.disabled = true; 
            loadingDiv.style.display = 'block';
            
            const formData = new FormData(regForm);
            pendingFormData = formData; // Save data for step 2
            
            // Send data to Google Apps Script
            fetch(SCRIPT_URL, { method: 'POST', body: formData })
                .then(response => response.json())
                .then(data => { 
                    if (data.result === "success") { 
                        // Hide registration form, show OTP form
                        registrationContainer.classList.add('hidden-field'); 
                        otpContainer.classList.remove('hidden-field'); 
                        showMessage(data.message, "#4cff4c"); // Show success message
                        otpInput.focus(); 
                    } else { 
                        throw new Error(data.message || "Something went wrong!"); 
                    } 
                })
                .catch(error => { 
                    showMessage("Error: " + error.message, "#ff4c4c"); 
                })
                .finally(() => { 
                    // Re-enable button and hide loading
                    submitButton.disabled = false; 
                    loadingDiv.style.display = 'none'; 
                }); 
        });
        
        // --- STEP 2: Handle OTP Form Submit (Verify & Register) ---
        otpForm.addEventListener('submit', function(e) { 
            e.preventDefault(); 
            const otpValue = otpInput.value.trim(); 
            
            // Basic OTP validation
            if (otpValue.length !== 6 || !/^\d+$/.test(otpValue)) { 
                showMessage("Please enter a valid 6-digit OTP.", "#ff4c4c"); 
                otpInput.classList.add('invalid'); 
                return; 
            } 
            
            verifyButton.disabled = true; 
            loadingDiv.style.display = 'block'; 
            
            if (!pendingFormData) { 
                showMessage("Error: Registration data lost. Please refresh and try again.", "#ff4c4c"); 
                verifyButton.disabled = false; 
                loadingDiv.style.display = 'none'; 
                return; 
            } 
            
            // Add the OTP to the saved form data
            pendingFormData.append('otp', otpValue); 
            
            // Send all data (including OTP) to Google Apps Script
            fetch(SCRIPT_URL, { method: 'POST', body: pendingFormData })
                .then(response => response.json())
                .then(data => { 
                    if (data.result === "success") { 
                        // Success! Hide OTP form, show Thank You message
                        otpContainer.classList.add('hidden-field'); 
                        thankyouContainer.classList.remove('hidden-field'); 
                        messageDiv.textContent = ''; 
                        regForm.reset(); // Clear original form
                        otpForm.reset(); // Clear OTP form
                        pendingFormData = null; // Clear stored data
                    } else { 
                        throw new Error(data.message || "Something went wrong!"); 
                    } 
                })
                .catch(error => { 
                    showMessage("Error: " + error.message, "#ff4c4c"); 
                    // If failed, remove the 'otp' parameter so user can retry
                    if(pendingFormData) { pendingFormData.delete('otp'); } 
                })
                .finally(() => { 
                    verifyButton.disabled = false; 
                    loadingDiv.style.display = 'none'; 
                }); 
        });
        
        // --- Client-side validation function ---
        function validateLocalForm() { 
            // Clear all previous error styles
            messageDiv.textContent = ''; 
            messageDiv.style.color = "#fff"; 
            nameInput.classList.remove('invalid'); 
            emailInput.classList.remove('invalid'); 
            nicInput.classList.remove('invalid'); 
            whatsappInput.classList.remove('invalid'); 
            batchInput.classList.remove('invalid'); 
            otpInput.classList.remove('invalid'); 
            
            // Get trimmed values
            const name = nameInput.value.trim(); 
            const email = emailInput.value.trim(); 
            const nic = nicInput.value.trim(); 
            const whatsapp = whatsappInput.value.trim(); 
            const batch = batchInput.value.trim(); 

            // 1. Check for empty fields
            if (!name || !email || !nic || !whatsapp || !batch) { 
                showMessage("Please fill in all required fields.", "#ff4c4c"); 
                // Add 'invalid' class to empty fields
                if (!name) nameInput.classList.add('invalid'); 
                if (!email) emailInput.classList.add('invalid'); 
                if (!nic) nicInput.classList.add('invalid'); 
                if (!whatsapp) whatsappInput.classList.add('invalid'); 
                if (!batch) batchInput.classList.add('invalid');
                return false; 
            } 
            // 2. Check email format
            if (!emailRegex.test(email)) { 
                showMessage("Please enter a valid email address.", "#ff4c4c"); 
                emailInput.classList.add('invalid'); 
                emailInput.focus(); 
                return false; 
            } 
            // 3. Check NIC format
            if (!nicRegex.test(nic)) { 
                showMessage("Please enter a valid SL NIC number (e.g. 123456789V or 123456789012).", "#ff4c4c"); 
                nicInput.classList.add('invalid'); 
                nicInput.focus(); 
                return false; 
            } 
            // 4. Check phone format
            if (!phoneRegex.test(whatsapp)) { 
                showMessage("Please enter a valid SL phone number (e.g., 0712345678).", "#ff4c4c"); 
                whatsappInput.classList.add('invalid'); 
                whatsappInput.focus(); 
                return false; 
            } 
            
            // 5. Check if batch is in the official list (case-insensitive)
            const batchLower = batch.toLowerCase();
            const isBatchValid = batchSuggestionsList.some(suggestion => suggestion.toLowerCase() === batchLower);

            if (!isBatchValid) {
                // If the typed batch is not in the list
                showMessage("Please enter or select a valid batch from the suggestions.", "#ff4c4c");
                batchInput.classList.add('invalid');
                batchInput.focus();
                return false;
            }

            // All validations passed
            return true; 
        }
        
        // --- Add event listeners to clear errors on input ---
        [nameInput, emailInput, nicInput, whatsappInput, batchInput, otpInput].forEach(input => { 
            input.addEventListener('input', () => { 
                // If user starts typing in an invalid field, remove the error
                if (input.classList.contains('invalid')) { 
                    input.classList.remove('invalid'); 
                    messageDiv.textContent = ''; // Clear the error message
                    messageDiv.style.color = "#fff"; 
                } 
            }); 
        });

        // --- 3. (NEW) Custom Cursor, Sparkle, & 3D Tilt Logic ---
        
        const customCursor = document.getElementById('custom-cursor');
        const formsToTilt = [registrationContainer, otpContainer, thankyouContainer];
        let canCreateSparkle = true;
        
        // Update cursor position, sparkle trail, and 3D tilt
        window.addEventListener('mousemove', (e) => {
            const { clientX, clientY } = e;
            
            // 1. Update Custom Cursor Position
            // Use requestAnimationFrame for smoother cursor following
            window.requestAnimationFrame(() => {
                customCursor.style.left = clientX + 'px';
                customCursor.style.top = clientY + 'px';
            });

            // 2. Create Sparkle Trail (Throttled)
            if (canCreateSparkle) {
                canCreateSparkle = false;
                
                const sparkle = document.createElement('div');
                sparkle.className = 'sparkle';
                
                // Position the sparkle at the cursor's location
                sparkle.style.left = clientX + 'px';
                sparkle.style.top = clientY + 'px';
                
                document.body.appendChild(sparkle);
                
                // Clean up the DOM after the animation (600ms)
                setTimeout(() => {
                    sparkle.remove();
                }, 600); // Must match animation-duration in CSS

                // Reset the flag after a short delay (50ms)
                setTimeout(() => {
                    canCreateSparkle = true;
                }, 50);
            }

            // 3. 3D Parallax Tilt Effect for visible forms
            formsToTilt.forEach(form => {
                if (!form.classList.contains('hidden-field')) {
                    const rect = form.getBoundingClientRect();
                    const maxTilt = 10; // Max tilt in degrees

                    // Calculate cursor position relative to the center of the form
                    const x = clientX - rect.left - rect.width / 2;
                    const y = clientY - rect.top - rect.height / 2;

                    // Calculate tilt angles
                    // Invert 'y' for natural up/down tilt
                    const tiltX = (y / (rect.height / 2)) * -maxTilt; 
                    const tiltY = (x / (rect.width / 2)) * maxTilt;

                    // Apply the 3D transform
                    form.style.transform = `perspective(1000px) rotateX(${tiltX}deg) rotateY(${tiltY}deg) scale(1.02)`;
                }
            });
        });

        // Add 'clicked' class to cursor on mousedown
        window.addEventListener('mousedown', () => {
            customCursor.classList.add('clicked');
        });

        // Remove 'clicked' class on mouseup
        window.addEventListener('mouseup', () => {
            customCursor.classList.remove('clicked');
        });

        // Reset 3D tilt when mouse leaves a form
        formsToTilt.forEach(form => {
            form.addEventListener('mouseleave', () => {
                form.style.transform = 'perspective(1000px) rotateX(0deg) rotateY(0deg) scale(1)';
            });
        });
        
    </script>
</body>
</html>

